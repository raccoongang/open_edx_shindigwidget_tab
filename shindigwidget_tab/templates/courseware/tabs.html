## mako
<%namespace name='static' file='/static_content.html'/>
<%!
 from django.utils.translation import ugettext as _
 from django.core.urlresolvers import reverse
 %>
<%page args="tab_list, active_page, default_tab, tab_image" />

<%
url_new_events = ''

def url_class(is_active):
  if is_active:
    return "active"
  return ""
%>

% for tab in tab_list:
  <%
    tab_is_active = tab.tab_id in (active_page, default_tab)
    tab_class = url_class(tab_is_active)
  %>
  <li>
  <a href="${tab.link_func(course, reverse) | h}" class="${tab_class}">
  ${_(tab.name) | h}
  % if tab_is_active:
      <span class="sr">, current location</span>
  %endif

  % if tab.tab_id == 'shindigwidget_tab':
      <%
        url_new_events = tab.link_func(course, reverse) + 'new_events/'
      %>
      <img src="" alt="${_('new events')}" class="label-new-events hidden" width="40" />
  % endif

  % if tab_image:
      ## Translators: 'needs attention' is an alternative string for the
      ## notification image that indicates the tab "needs attention".
      <img src="${tab_image}" alt="${_('needs attention')}" />
  %endif
  </a>
  </li>
% endfor

<script type="text/javascript">
(function() {
    if ("${url_new_events}"){
       $.ajax({
            url: "${url_new_events}",
            type: "POST",
            success: function (data) {
                if (data.path_img) {
                    var $label = $('.label-new-events');
                    $label.attr('src', data.path_img);
                    $label.removeClass('hidden');
                }
            }
        });
    }
}());
</script>